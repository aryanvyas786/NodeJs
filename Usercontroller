import { Request, Response } from 'express';
import User from '../models/User';
import Address from '../models/Address';

export const addUser = async (req: Request, res: Response) => {
  try {
    const userData = {
      firstName: req.body.firstName,
      lastName: req.body.lastName,
      email: req.body.email,
      profilePhoto: req.file.path,
      appointmentLetter: req.body.appointmentLetter,
    };

    const user = await User.create(userData);
    
    const addressData = {
      userId: user.id,
      companyAddress: req.body.companyAddress,
      companyCity: req.body.companyCity,
      companyState: req.body.companyState,
      companyZip: req.body.companyZip,
      homeAddress: req.body.homeAddress,
      homeCity: req.body.homeCity,
      homeState: req.body.homeState,
      homeZip: req.body.homeZip,
    };

    await Address.create(addressData);

    res.status(201).json(user);
  } catch (error) {
    res.status(500).json({ message: error.message });
  }
};

// Other controller functions (viewUser, editUser) should be implemented similarly
